/* Generated from Java with JSweet 2.0.1 - http://www.jsweet.org */
var ru;
(function (ru) {
    var bvb;
    (function (bvb) {
        var Dungeons = (function () {
            function Dungeons() {
            }
            Dungeons.dungeonIDs_$LI$ = function () { if (Dungeons.dungeonIDs == null)
                Dungeons.dungeonIDs = (new java.util.ArrayList()); return Dungeons.dungeonIDs; };
            ;
            Dungeons.dungeonNames_$LI$ = function () { if (Dungeons.dungeonNames == null)
                Dungeons.dungeonNames = (new java.util.ArrayList()); return Dungeons.dungeonNames; };
            ;
            Dungeons.init = function () {
                Dungeons.add(2302, "TycoonTower of Tokyo \u2605\u2605");
                Dungeons.add(2302, "TycoonTower of NYC \u2605\u2605");
                Dungeons.add(2302, "TycoonTower of Cairo \u2605\u2605");
                Dungeons.add(2302, "TycoonTower of Paris \u2605\u2605");
                Dungeons.add(2302, "TycoonTower of London \u2605\u2605");
                Dungeons.add(2202, "MtGoldenest of Tokyo \u2605\u2605");
                Dungeons.add(2202, "MtGoldenest of NYC \u2605\u2605");
                Dungeons.add(2202, "MtGoldenest of Cairo \u2605\u2605");
                Dungeons.add(2202, "MtGoldenest of Paris \u2605\u2605");
                Dungeons.add(2202, "MtGoldenest of London \u2605\u2605");
                Dungeons.add(2102, "Gold wood of Tokyo \u2605\u2605");
                Dungeons.add(2102, "Gold wood of NYC \u2605\u2605");
                Dungeons.add(2102, "Gold wood of Cairo \u2605\u2605");
                Dungeons.add(2102, "Gold wood of Paris \u2605\u2605");
                Dungeons.add(2102, "Gold wood of London \u2605\u2605");
                Dungeons.add(2403, "Gold Slime Tower \u2605\u2605\u2605");
                Dungeons.add(3404, "Sliamond Tower \u2605\u2605\u2605\u2605");
                Dungeons.add(4405, "King Sliamond Tower \u2605\u2605\u2605\u2605\u2605");
                Dungeons.add(101, "Picnic Grove \u2605");
                Dungeons.add(201, "Goblin House \u2605");
                Dungeons.add(301, "Spell Academy \u2605");
                Dungeons.add(401, "Skittery Park \u2605");
                Dungeons.add(501, "Slimeville \u2605");
                Dungeons.add(5102, "Ghost House \u2605\u2605");
                Dungeons.add(5202, "Flame Cave \u2605\u2605");
                Dungeons.add(5302, "Mimictown \u2605\u2605");
                Dungeons.add(5502, "Boneboat \u2605\u2605");
                Dungeons.add(3303, "Samurai Dojo \u2605\u2605\u2605");
                Dungeons.add(3903, "House of Nanjaro(weekends) \u2605\u2605\u2605");
                Dungeons.add(5403, "Royal Rat Trove \u2605\u2605\u2605");
                Dungeons.add(5603, "Aja\'s Tower \u2605\u2605\u2605");
                Dungeons.add(9103, "Dragon Castle \u2605\u2605\u2605");
                Dungeons.add(1103, "Weird Woody Woods \u2605\u2605\u2605");
                Dungeons.add(1203, "Fort Goblin \u2605\u2605\u2605");
                Dungeons.add(1503, "Slimurai Hamlet \u2605\u2605\u2605");
                Dungeons.add(1403, "Beegarden \u2605\u2605\u2605");
                Dungeons.add(1303, "Sorcery School \u2605\u2605\u2605");
                Dungeons.add(6104, "King Ghost\'s Palace \u2605\u2605\u2605\u2605");
                Dungeons.add(6204, "Fire Golem Cave \u2605\u2605\u2605\u2605");
                Dungeons.add(6304, "Mimiqueen\'s Villa \u2605\u2605\u2605\u2605");
                Dungeons.add(9204, "Asparaguster\'s Ranch \u2605\u2605\u2605\u2605");
                Dungeons.add(6504, "Cap\'n Bone\'s Big Boat \u2605\u2605\u2605\u2605");
                Dungeons.add(6705, "Mysterious Hard Labor Zone \u2605\u2605\u2605\u2605\u2605");
                Dungeons.add(9305, "Legendary Dragonkeep \u2605\u2605\u2605\u2605\u2605");
                Dungeons.add(4105, "Holy Thelomon Castle \u2605\u2605\u2605\u2605\u2605");
                Dungeons.add(3505, "Garbi Desert \u2605\u2605\u2605\u2605\u2605");
                Dungeons.add(3803, "Morning Porkpark \u2605\u2605\u2605");
                Dungeons.add(3103, "Pignoon Paradise \u2605\u2605\u2605");
                Dungeons.add(2503, "Bistro Porkpork \u2605\u2605\u2605");
                Dungeons.add(3003, "Pignite Farm \u2605\u2605\u2605");
                Dungeons.add(1603, "Bonefield \u2605\u2605\u2605");
                Dungeons.add(8003, "Wacky Hanami Party \u2605\u2605\u2605");
                Dungeons.add(8103, "Toilet Island \u2605\u2605\u2605");
                Dungeons.add(5803, "Snowbytown Square \u2605\u2605\u2605");
                Dungeons.add(7003, "Mamayan Ruins \u2605\u2605\u2605\u2605");
                Dungeons.add(7103, "Heck Yeah High School \u2605\u2605\u2605\u2605");
                Dungeons.add(7203, "Turtle Bath \u2605\u2605\u2605\u2605");
                Dungeons.add(7303, "Crocodile Eighteen \u2605\u2605\u2605\u2605");
                Dungeons.add(1703, "Pumpkin Patch \u2605\u2605\u2605\u2605");
                Dungeons.add(4704, "Onion Hotel \u2605\u2605\u2605\u2605\u2605");
                Dungeons.add(4005, "Maestro Nobiyo\'s Farm \u2605\u2605\u2605\u2605\u2605");
                Dungeons.add(4505, "Danmaku Castle \u2605\u2605\u2605\u2605\u2605");
                Dungeons.add(5705, "Santa Flophouse \u2605\u2605\u2605\u2605\u2605");
                Dungeons.add(6005, "Lavender Avenue Shop \u2605\u2605\u2605\u2605\u2605");
                Dungeons.add(5905, "Raid Tower \u2605\u2605\u2605\u2605\u2605");
                Dungeons.add(4205, "Fort Supopon \u2605\u2605\u2605\u2605\u2605");
                Dungeons.add(4805, "Heaven\'s Door \u2605\u2605\u2605\u2605\u2605");
            };
            Dungeons.add = function (id, name) {
                if (id === 0 || (name.length === 0)) {
                    return;
                }
                Dungeons.dungeonIDs_$LI$().add(id);
                Dungeons.dungeonNames_$LI$().add(name);
            };
            return Dungeons;
        }());
        Dungeons.MIN_LEVEL = 1;
        Dungeons.MAX_LEVEL = 99;
        Dungeons.ERROR_SPELL = "{ \"error\": \"invalid spell\"}";
        bvb.Dungeons = Dungeons;
        Dungeons["__class"] = "ru.bvb.Dungeons";
    })(bvb = ru.bvb || (ru.bvb = {}));
})(ru || (ru = {}));
(function (ru) {
    var bvb;
    (function (bvb) {
        var Main = (function () {
            function Main() {
            }
            Main.main = function (args) {
                if (args == null) {
                    return;
                }
                if (args.length === 0 || (function (o1, o2) { if (o1 && o1.equals) {
                    return o1.equals(o2);
                }
                else {
                    return o1 === o2;
                } })(args[0], "--help") || (function (o1, o2) { if (o1 && o1.equals) {
                    return o1.equals(o2);
                }
                else {
                    return o1 === o2;
                } })(args[0], "-h")) {
                    console.info(Main.info);
                }
                else if (Main.tryToTest(args)) {
                }
                else if (Main.tryToRenewSpell(args)) {
                }
                else if (Main.tryToCreateSpell(args)) {
                }
                else if (Main.tryToPrintAll(args)) {
                }
                else if (Main.tryToDecodeSpell(args)) {
                }
            };
            /*private*/ Main.tryToTest = function (args) {
                if (!((function (o1, o2) { if (o1 && o1.equals) {
                    return o1.equals(o2);
                }
                else {
                    return o1 === o2;
                } })(args[0], "--test") || (function (o1, o2) { if (o1 && o1.equals) {
                    return o1.equals(o2);
                }
                else {
                    return o1 === o2;
                } })(args[0], "-t"))) {
                    return false;
                }
                var spellKey = "BQT21YGTCIMYUPDN4J3AC589";
                Main.printTest(spellKey);
                return true;
            };
            /*private*/ Main.tryToRenewSpell = function (args) {
                if (!((function (o1, o2) { if (o1 && o1.equals) {
                    return o1.equals(o2);
                }
                else {
                    return o1 === o2;
                } })(args[0], "--renew") || (function (o1, o2) { if (o1 && o1.equals) {
                    return o1.equals(o2);
                }
                else {
                    return o1 === o2;
                } })(args[0], "-r"))) {
                    return false;
                }
                var spellKey = args[1];
                for (var i = 2; i < args.length; i++) {
                    spellKey += args[i];
                }
                ;
                Main.printRenewSpell(spellKey);
                return true;
            };
            /*private*/ Main.tryToCreateSpell = function (args) {
                if (!((function (o1, o2) { if (o1 && o1.equals) {
                    return o1.equals(o2);
                }
                else {
                    return o1 === o2;
                } })(args[0], "--create") || (function (o1, o2) { if (o1 && o1.equals) {
                    return o1.equals(o2);
                }
                else {
                    return o1 === o2;
                } })(args[0], "-c")) || args.length !== 5) {
                    return false;
                }
                var isJapan = javaemul.internal.IntegerHelper.parseInt(args[1]) !== 0;
                var dungeonId = javaemul.internal.IntegerHelper.parseInt(args[2]);
                var level = javaemul.internal.IntegerHelper.parseInt(args[3]);
                var times = javaemul.internal.IntegerHelper.parseInt(args[4]);
                Main.printGenerateSpellCodeNTimes(isJapan, dungeonId, level, times);
                return true;
            };
            /*private*/ Main.tryToDecodeSpell = function (args) {
                var spellKey = args[0];
                for (var i = 1; i < args.length; i++) {
                    spellKey += args[i];
                }
                ;
                Main.printSpellData(spellKey);
                return true;
            };
            /*private*/ Main.tryToPrintAll = function (args) {
                if (!(function (o1, o2) { if (o1 && o1.equals) {
                    return o1.equals(o2);
                }
                else {
                    return o1 === o2;
                } })(args[0], "--all") || args.length !== 4) {
                    return false;
                }
                var isJapan = javaemul.internal.IntegerHelper.parseInt(args[1]) !== 0;
                var level = javaemul.internal.IntegerHelper.parseInt(args[2]);
                var times = javaemul.internal.IntegerHelper.parseInt(args[3]);
                ru.bvb.Dungeons.init();
                for (var i = 0; i < ru.bvb.Dungeons.dungeonIDs_$LI$().size(); i++) {
                    var dungeonId = ru.bvb.Dungeons.dungeonIDs_$LI$().get(i);
                    var dungeonName = ru.bvb.Dungeons.dungeonNames_$LI$().get(i);
                    console.info(dungeonName);
                    Main.printGenerateSpellCodeNTimes(isJapan, dungeonId, level, times);
                    console.info("");
                }
                ;
                return true;
            };
            Main.printSpellData = function (spellKey) {
                var result = Main.getSpellData(spellKey);
                console.info(result);
            };
            Main.printTest = function (spellKey) {
                ru.bvb.oniongames.plugin.util.SpellEncoder.useFakeData = true;
                var spell = new ru.bvb.oniongames.plugin.DungeonSpell();
                spell.decodeKey(spellKey);
                var key = spell.generateNewKey();
                ru.bvb.oniongames.plugin.util.SpellEncoder.useFakeData = false;
                console.info(key);
                console.info(/* equals */ (function (o1, o2) { if (o1 && o1.equals) {
                    return o1.equals(o2);
                }
                else {
                    return o1 === o2;
                } })(key, "879XFLENA08CETEPIS5B37E9"));
            };
            Main.printRenewSpell = function (spellKey) {
                var result = Main.getRenewSpell(spellKey);
                console.info(result);
            };
            Main.printGenerateSpellCodeNTimes = function (isJP, dungeonId, dungeonLevel, times) {
                for (var i = 0; i < times; i++) {
                    var key = Main.getGenerateSpellCode(isJP, dungeonId, dungeonLevel);
                    console.info(key);
                }
                ;
            };
            Main.getSpellData = function (spellKey) {
                var dungeonSpell = new ru.bvb.oniongames.plugin.DungeonSpell();
                dungeonSpell.decodeKey(spellKey);
                return dungeonSpell.getJSON();
            };
            Main.getRenewSpell = function (spellKey) {
                var dungeonSpell = new ru.bvb.oniongames.plugin.DungeonSpell();
                dungeonSpell.decodeKey(spellKey);
                var newKey = dungeonSpell.generateNewKey();
                if (newKey == null) {
                    return ru.bvb.Dungeons.ERROR_SPELL;
                }
                return newKey;
            };
            Main.getGenerateSpellCode = function (isJP, dungeonId, dungeonLevel) {
                var newKey = ru.bvb.oniongames.plugin.util.SpellEncoder.generateRandomValidKey(isJP, dungeonId, dungeonLevel);
                if (newKey == null) {
                    return ru.bvb.Dungeons.ERROR_SPELL;
                }
                return newKey;
            };
            return Main;
        }());
        Main.info = "returns spell info by spell code\nZZZZ 1ZZ4 ZZZ Z ZZZZZ...\n\nreturns spell with current date\n--renew ZZZZ 1ZZ4 ZZZ Z ZZZZZ\n-r ZZZZ 1ZZ4 ZZZ Z ZZZZZ\n\nprints out spellCodes from input isJapan, dungeonId, level, N times\n--create 0 424242 22 2\n-c 0 424242 22 2\n\nprints out spellCodes for all special dungeons isJapan, N times, level--all 0 42 22\n";
        bvb.Main = Main;
        Main["__class"] = "ru.bvb.Main";
    })(bvb = ru.bvb || (ru.bvb = {}));
})(ru || (ru = {}));
(function (ru) {
    var bvb;
    (function (bvb) {
        var oniongames;
        (function (oniongames) {
            var plugin;
            (function (plugin) {
                var crypto;
                (function (crypto) {
                    var GiftSpell = (function () {
                        function GiftSpell() {
                        }
                        GiftSpell.create_JP = function (appIdKey, randomSeed, dungeonId, dungeonLevel, timeStampMs) {
                            var signature = appIdKey.substring(appIdKey.length - 7).toLowerCase();
                            var encodedTime = Math.floor((new Date(timeStampMs).getTime() - GiftSpell.BaseUnixTimeForJP) / 10000);
                            var randSeed = (randomSeed | 0);
                            var encodedSignature = ru.bvb.oniongames.plugin.util.Digest.str36ToLong(signature);
                            var sigTimeEncoded = (encodedSignature + encodedTime) % 10000;
                            var partOne = ru.bvb.oniongames.plugin.util.Digest.stringWithFill(ru.bvb.oniongames.plugin.util.Digest.long71String_Hiragana(encodedSignature ^ encodedTime % 10 * 1000000 + encodedTime % 1000 * 1000 + encodedTime % 1000), "\u308b", 6);
                            var partTwo = ru.bvb.oniongames.plugin.util.Digest.stringWithFill(ru.bvb.oniongames.plugin.util.Digest.long71String_Hiragana(encodedTime ^ Math.floor((randSeed * 1000 + randSeed % 1000))), "\u308b", 4);
                            var partThree = ru.bvb.oniongames.plugin.util.Digest.stringWithFill(ru.bvb.oniongames.plugin.util.Digest.long71String_Hiragana(Math.floor((((Math.floor(dungeonId) ^ sigTimeEncoded) | 0)))), "\u308b", 3);
                            var partFour = ru.bvb.oniongames.plugin.util.Digest.stringWithFill(ru.bvb.oniongames.plugin.util.Digest.long71String_Hiragana(Math.floor((((Math.floor(dungeonLevel) ^ sigTimeEncoded % 1000) | 0)))), "\u308b", 2);
                            var partFive = ru.bvb.oniongames.plugin.util.Digest.stringWithFill(ru.bvb.oniongames.plugin.util.Digest.long71String_Hiragana(Math.floor(randSeed)), "\u308b", 2);
                            var encodedKey = ru.bvb.oniongames.plugin.util.Digest.md5(partOne + partTwo + partThree + partFour + partFive + GiftSpell.KeyForMD5);
                            var resultSignature = ru.bvb.oniongames.plugin.util.Digest.stringWithFill(ru.bvb.oniongames.plugin.util.Digest.long71String_Hiragana(ru.bvb.oniongames.plugin.util.Digest.str36ToLong(encodedKey.substring(encodedKey.length - 8))), "\u308b", 7);
                            return partOne + partTwo + partThree + partFour + partFive + resultSignature;
                        };
                        GiftSpell.create_OTHER = function (appIdKey, seed, dungeonId, dungeonLevel, timestampMs) {
                            var partOne = ru.bvb.oniongames.plugin.util.Digest.stringWithFillLeft(appIdKey.substring(appIdKey.length - 7).toLowerCase(), "0", 7);
                            var partTwo = ru.bvb.oniongames.plugin.util.Digest.stringWithFillLeft(ru.bvb.oniongames.plugin.util.Digest.long36String(Math.floor(((dungeonId / 100 | 0)))), "0", 2);
                            var partThree = ru.bvb.oniongames.plugin.util.Digest.stringWithFillLeft(ru.bvb.oniongames.plugin.util.Digest.long36String(Math.floor((dungeonId % 100))), "0", 1);
                            var partFour = ru.bvb.oniongames.plugin.util.Digest.stringWithFillLeft(ru.bvb.oniongames.plugin.util.Digest.long36String(Math.floor(dungeonLevel)), "0", 2);
                            var timestampOffset = Math.floor((Math.floor(((new Date(timestampMs)).getTime() - GiftSpell.BaseUnixTimeForOTHER) / 1000)) / 10);
                            var encodedTimestamp = ru.bvb.oniongames.plugin.util.Digest.stringWithFillLeft(ru.bvb.oniongames.plugin.util.Digest.long36String(timestampOffset), "0", 5);
                            var resultShift = ru.bvb.oniongames.plugin.util.Digest.stringWithFillLeft(ru.bvb.oniongames.plugin.util.Digest.long36String(seed), "0", 1);
                            var secondEncoded = GiftSpell.shiftString_OTHER(encodedTimestamp, seed, true);
                            var firstEncoded = GiftSpell.shiftString_OTHER(partOne + partTwo + partThree + partFour, seed + timestampOffset, true);
                            var threeParts = firstEncoded + secondEncoded + resultShift;
                            var signature = ru.bvb.oniongames.plugin.util.Digest.md5(threeParts + GiftSpell.KeyForMD5);
                            signature = signature.substring(signature.length - 6);
                            return (threeParts + signature).toUpperCase();
                        };
                        GiftSpell.getCreateDate_JP = function (var0) {
                            return new Date(GiftSpell.getTimeInterval_JP(var0) * 10000 + GiftSpell.BaseUnixTimeForJP);
                        };
                        GiftSpell.getCreateDate_OTHER = function (var0) {
                            var var1 = ru.bvb.oniongames.plugin.util.Digest.str36ToLong(GiftSpell.substring_OTHER(var0, 12, 17));
                            return new Date(GiftSpell.BaseUnixTimeForOTHER + var1 * 10000);
                        };
                        GiftSpell.getDungeonID_JP = function (var0) {
                            var var1 = GiftSpell.getTimeInterval_JP(var0);
                            var var3 = GiftSpell.getFolkCraftKey_JP(var0);
                            return ((ru.bvb.oniongames.plugin.util.Digest.str71ToInt_Hiragana(/* replaceAll */ var0.substring(10, 13).replace(new RegExp("\u308b", 'g'), "")) ^ (var1 + var3) % 10000) | 0);
                        };
                        GiftSpell.getDungeonID_OTHER = function (source) {
                            var first = GiftSpell.substring_OTHER(source, 7, 9);
                            var last = GiftSpell.substring_OTHER(source, 9, 10);
                            return ((100 * ru.bvb.oniongames.plugin.util.Digest.str36ToLong(first) + ru.bvb.oniongames.plugin.util.Digest.str36ToLong(last)) | 0);
                        };
                        GiftSpell.getFolkCraftKey_JP = function (source) {
                            var var1 = GiftSpell.getTimeInterval_JP(source);
                            return ru.bvb.oniongames.plugin.util.Digest.str71ToInt_Hiragana(/* replaceAll */ source.substring(0, 6).replace(new RegExp("\u308b", 'g'), "")) ^ var1 % 10 * 1000000 + var1 % 1000 * 1000 + var1 % 1000;
                        };
                        GiftSpell.getFolkCraftKey_OTHER = function (paramString) {
                            return ru.bvb.oniongames.plugin.util.Digest.str36ToLong(GiftSpell.substring_OTHER(paramString, 0, 7));
                        };
                        GiftSpell.getLevel_JP = function (var0) {
                            var var1 = GiftSpell.getTimeInterval_JP(var0);
                            var var3 = GiftSpell.getFolkCraftKey_JP(var0);
                            return ((ru.bvb.oniongames.plugin.util.Digest.str71ToInt_Hiragana(/* replaceAll */ var0.substring(13, 15).replace(new RegExp("\u308b", 'g'), "")) ^ (var1 + var3) % 1000) | 0);
                        };
                        GiftSpell.getLevel_OTHER = function (paramString) {
                            return (ru.bvb.oniongames.plugin.util.Digest.str36ToLong(GiftSpell.substring_OTHER(paramString, 10, 12)) | 0);
                        };
                        GiftSpell.getTimeInterval_JP = function (var0) {
                            var var1 = ru.bvb.oniongames.plugin.util.Digest.str71ToInt_Hiragana(/* replaceAll */ var0.substring(15, 17).replace(new RegExp("\u308b", 'g'), ""));
                            return ru.bvb.oniongames.plugin.util.Digest.str71ToInt_Hiragana(/* replaceAll */ var0.substring(6, 10).replace(new RegExp("\u308b", 'g'), "")) ^ var1 * 1000 + var1 % 1000;
                        };
                        /*private*/ GiftSpell.shiftAlphanumeric_OTHER = function (var0, var1) {
                            var var3 = 0;
                            var var2;
                            if (var0 >= 48 && var0 <= 57) {
                                var2 = var0 - 48;
                            }
                            else if (var0 >= 97 && var0 <= 122) {
                                var2 = var0 + 10 - 97;
                            }
                            else {
                                var2 = var3;
                                if (var0 >= 65) {
                                    var2 = var3;
                                    if (var0 <= 90) {
                                        var2 = var0 + 10 - 65;
                                    }
                                }
                            }
                            var var4 = var2 + var1;
                            while ((true)) {
                                var1 = var4;
                                if (var4 < 36) {
                                    while ((var1 < 0)) {
                                        var1 += 36;
                                    }
                                    ;
                                    return var1 < 10 ? (var1 + 48) : (var1 - 10 + 97);
                                }
                                var4 -= 36;
                            }
                            ;
                        };
                        /*private*/ GiftSpell.shiftString_OTHER = function (var0, var1, shiftFlag) {
                            var chars = (var0).split('');
                            for (var i = 0; i < chars.length; ++i) {
                                var1 = GiftSpell.simpleRand_OTHER(var1);
                                var var6 = ((var1 % 36) | 0);
                                var var4 = (chars[i]).charCodeAt(0);
                                if (!shiftFlag) {
                                    var6 = -var6;
                                }
                                var result = GiftSpell.shiftAlphanumeric_OTHER(var4, var6);
                                chars[i] = String.fromCharCode(result);
                            }
                            ;
                            return GiftSpell.fromCharCode(chars);
                        };
                        GiftSpell.fromCharCode = function (chars) {
                            var stringBuilder = new java.lang.StringBuilder();
                            for (var i = 0; i < chars.length; i++) {
                                var codePoint = (chars[i]).charCodeAt(0);
                                stringBuilder.append(String.fromCharCode(codePoint));
                            }
                            ;
                            return stringBuilder.toString();
                        };
                        /*private*/ GiftSpell.simpleRand_OTHER = function (paramLong) {
                            return ((1103515245 * paramLong) + 12347) % -2147483648;
                        };
                        GiftSpell.substring_OTHER = function (source, beginIndex, endIndex) {
                            source = source.toLowerCase();
                            var var5 = source.substring(0, 12);
                            var var7 = source.substring(12, 17);
                            var var0 = source.substring(17, 18);
                            var signature = source.substring(18);
                            var var3 = ru.bvb.oniongames.plugin.util.Digest.str36ToLong(var0);
                            var7 = GiftSpell.shiftString_OTHER(var7, var3, false);
                            var5 = GiftSpell.shiftString_OTHER(var5, var3 + ru.bvb.oniongames.plugin.util.Digest.str36ToLong(var7), false);
                            return (var5 + var7 + var0 + signature).substring(beginIndex, endIndex);
                        };
                        GiftSpell.verify_JP = function (source) {
                            source = source.replace(new RegExp("\\s+", 'g'), "");
                            var paramString1 = source.substring(0, 6);
                            var str1 = source.substring(6, 10);
                            var str2 = source.substring(10, 13);
                            var str3 = source.substring(13, 15);
                            var str4 = source.substring(15, 17);
                            var toCompareSig = source.substring(17);
                            var encoded = ru.bvb.oniongames.plugin.util.Digest.md5(paramString1 + str1 + str2 + str3 + str4 + GiftSpell.KeyForMD5);
                            var sig = ru.bvb.oniongames.plugin.util.Digest.str36ToLong(encoded.substring(encoded.length - 8));
                            var toHiragana = ru.bvb.oniongames.plugin.util.Digest.long71String_Hiragana(sig);
                            var toSource = ru.bvb.oniongames.plugin.util.Digest.stringWithFill(toHiragana, "\u308b", 7);
                            if (!(function (o1, o2) { if (o1 && o1.equals) {
                                return o1.equals(o2);
                            }
                            else {
                                return o1 === o2;
                            } })(toCompareSig, toSource)) {
                                return ru.bvb.oniongames.plugin.crypto.VerifyState.NotMatchMD5;
                            }
                            return ru.bvb.oniongames.plugin.crypto.VerifyState.Normal;
                        };
                        GiftSpell.verify_OTHER = function (source) {
                            source = source.replace(new RegExp("\\s+", 'g'), "");
                            if (source.length !== 24) {
                                return ru.bvb.oniongames.plugin.crypto.VerifyState.Unknown;
                            }
                            source = source.toLowerCase();
                            var firstPart = source.substring(0, 18);
                            var signaturePart = source.substring(18);
                            var result = ru.bvb.oniongames.plugin.util.Digest.md5(firstPart + GiftSpell.KeyForMD5).toLowerCase();
                            if (!(function (o1, o2) { if (o1 && o1.equals) {
                                return o1.equals(o2);
                            }
                            else {
                                return o1 === o2;
                            } })(result.substring(result.length - 6), signaturePart)) {
                                return ru.bvb.oniongames.plugin.crypto.VerifyState.NotMatchMD5;
                            }
                            return ru.bvb.oniongames.plugin.crypto.VerifyState.Normal;
                        };
                        return GiftSpell;
                    }());
                    GiftSpell.BaseUnixTimeForJP = 1420038000000;
                    GiftSpell.BaseUnixTimeForOTHER = 1420005600000;
                    GiftSpell.KeyForMD5 = "dydy";
                    crypto.GiftSpell = GiftSpell;
                    GiftSpell["__class"] = "ru.bvb.oniongames.plugin.crypto.GiftSpell";
                })(crypto = plugin.crypto || (plugin.crypto = {}));
            })(plugin = oniongames.plugin || (oniongames.plugin = {}));
        })(oniongames = bvb.oniongames || (bvb.oniongames = {}));
    })(bvb = ru.bvb || (ru.bvb = {}));
})(ru || (ru = {}));
(function (ru) {
    var bvb;
    (function (bvb) {
        var oniongames;
        (function (oniongames) {
            var plugin;
            (function (plugin) {
                var crypto;
                (function (crypto) {
                    var VerifyState;
                    (function (VerifyState) {
                        VerifyState[VerifyState["Normal"] = 0] = "Normal";
                        VerifyState[VerifyState["NotMatchMD5"] = 1] = "NotMatchMD5";
                        VerifyState[VerifyState["Unknown"] = 2] = "Unknown";
                    })(VerifyState = crypto.VerifyState || (crypto.VerifyState = {}));
                })(crypto = plugin.crypto || (plugin.crypto = {}));
            })(plugin = oniongames.plugin || (oniongames.plugin = {}));
        })(oniongames = bvb.oniongames || (bvb.oniongames = {}));
    })(bvb = ru.bvb || (ru.bvb = {}));
})(ru || (ru = {}));
(function (ru) {
    var bvb;
    (function (bvb) {
        var oniongames;
        (function (oniongames) {
            var plugin;
            (function (plugin) {
                var DungeonSpell = (function () {
                    function DungeonSpell() {
                        /*private*/ this.isValid = false;
                        /*private*/ this.isJP = false;
                        if (this.spellDate === undefined)
                            this.spellDate = null;
                        if (this.dungeonId === undefined)
                            this.dungeonId = 0;
                        if (this.seed === undefined)
                            this.seed = 0;
                        if (this.dungeonLevel === undefined)
                            this.dungeonLevel = 0;
                    }
                    DungeonSpell.prototype.decodeKey = function (spellKey) {
                        var source = spellKey.replace(new RegExp("\\s+", 'g'), "");
                        var isValid;
                        isValid = ru.bvb.oniongames.plugin.crypto.GiftSpell.verify_OTHER(source);
                        if (isValid === ru.bvb.oniongames.plugin.crypto.VerifyState.Normal) {
                            return this.decodeValidKey(source, false);
                        }
                        isValid = ru.bvb.oniongames.plugin.crypto.GiftSpell.verify_JP(source);
                        if (isValid === ru.bvb.oniongames.plugin.crypto.VerifyState.Normal) {
                            return this.decodeValidKey(source, true);
                        }
                        return false;
                    };
                    /*private*/ DungeonSpell.prototype.decodeValidKey = function (source, isJP) {
                        try {
                            if (isJP) {
                                this.spellDate = ru.bvb.oniongames.plugin.crypto.GiftSpell.getCreateDate_JP(source);
                                this.dungeonId = ru.bvb.oniongames.plugin.crypto.GiftSpell.getDungeonID_JP(source);
                                this.seed = ru.bvb.oniongames.plugin.crypto.GiftSpell.getFolkCraftKey_JP(source);
                                this.dungeonLevel = ru.bvb.oniongames.plugin.crypto.GiftSpell.getLevel_JP(source);
                            }
                            else {
                                this.spellDate = ru.bvb.oniongames.plugin.crypto.GiftSpell.getCreateDate_OTHER(source);
                                this.dungeonId = ru.bvb.oniongames.plugin.crypto.GiftSpell.getDungeonID_OTHER(source);
                                this.seed = ru.bvb.oniongames.plugin.crypto.GiftSpell.getFolkCraftKey_OTHER(source);
                                this.dungeonLevel = ru.bvb.oniongames.plugin.crypto.GiftSpell.getLevel_OTHER(source);
                            }
                            this.isJP = isJP;
                            this.isValid = true;
                        }
                        catch (e) {
                            this.isValid = false;
                            return false;
                        }
                        ;
                        return true;
                    };
                    DungeonSpell.prototype.generateNewKey = function () {
                        var appIdKey = ru.bvb.oniongames.plugin.util.SpellEncoder.generateAppId();
                        var randomSeed = ru.bvb.oniongames.plugin.util.SpellEncoder.generateRandomSeed(this.isJP);
                        var unixTimeMs = ru.bvb.oniongames.plugin.util.SpellEncoder.getTime();
                        return ru.bvb.oniongames.plugin.util.SpellEncoder.encode(appIdKey, randomSeed, this.dungeonId, this.dungeonLevel, unixTimeMs, this.isJP);
                    };
                    DungeonSpell.prototype.getJSON = function () {
                        if (!this.isValid)
                            return ru.bvb.Dungeons.ERROR_SPELL;
                        var unixTimestamp = Math.floor(this.spellDate.getTime() / 1000);
                        var resultStr = "{";
                        resultStr += "\"dungeon_id\": " + this.dungeonId + ", ";
                        resultStr += "\"dungeon_name\": \"" + DungeonSpell.getDungeonName(this.dungeonId) + "\", ";
                        resultStr += "\"level\": " + this.dungeonLevel + ", ";
                        resultStr += "\"seed\": " + this.seed + ", ";
                        resultStr += "\"timestamp\": " + unixTimestamp + ", ";
                        resultStr += "\"localDate\": " + "\"" + this.spellDate + "\"";
                        resultStr += "}";
                        return resultStr;
                    };
                    DungeonSpell.getDungeonName = function (dungeonID) {
                        for (var i = 0; i < ru.bvb.Dungeons.dungeonIDs_$LI$().size(); i++) {
                            if (dungeonID === ru.bvb.Dungeons.dungeonIDs_$LI$().get(i)) {
                                return ru.bvb.Dungeons.dungeonNames_$LI$().get(i);
                            }
                        }
                        ;
                        return "UNKNOWN_DUNGEON";
                    };
                    DungeonSpell.separateKey = function (spellKey) {
                        var SEP = 4;
                        var result = "";
                        if (spellKey.length < SEP) {
                            return spellKey;
                        }
                        for (var i = 0; i < spellKey.length; i += SEP) {
                            result += spellKey.substring(i, i + SEP);
                            if (i + SEP < spellKey.length) {
                                result += " ";
                            }
                        }
                        ;
                        return result;
                    };
                    return DungeonSpell;
                }());
                plugin.DungeonSpell = DungeonSpell;
                DungeonSpell["__class"] = "ru.bvb.oniongames.plugin.DungeonSpell";
            })(plugin = oniongames.plugin || (oniongames.plugin = {}));
        })(oniongames = bvb.oniongames || (bvb.oniongames = {}));
    })(bvb = ru.bvb || (ru.bvb = {}));
})(ru || (ru = {}));
(function (ru) {
    var bvb;
    (function (bvb) {
        var oniongames;
        (function (oniongames) {
            var plugin;
            (function (plugin) {
                var util;
                (function (util) {
                    var Digest = (function () {
                        function Digest() {
                        }
                        Digest.bin2hex = function (arrby) {
                            var stringBuffer = new java.lang.StringBuffer();
                            var n = arrby.length;
                            for (var i = 0; i < n; ++i) {
                                var string = javaemul.internal.IntegerHelper.toHexString(arrby[i] & 255);
                                if (string.length === 1) {
                                    stringBuffer.append("0");
                                }
                                stringBuffer.append(string);
                            }
                            ;
                            return stringBuffer.toString();
                        };
                        Digest.long36String = function (l) {
                            if (l === 0) {
                                return "0";
                            }
                            var stringBuilder = new java.lang.StringBuilder();
                            while ((l > 0)) {
                                var n = ((l % 36) | 0);
                                if (n < 10) {
                                    stringBuilder.append(n);
                                }
                                else {
                                    stringBuilder.append(String.fromCharCode((n + 87)));
                                }
                                l = Math.floor(l / 36);
                            }
                            ;
                            var result = stringBuilder.toString();
                            result = Digest.reverseIt(result);
                            return result;
                        };
                        Digest.long71String_Hiragana = function (paramLong) {
                            var arrayOfString = (function (s) { var a = []; while (s-- > 0)
                                a.push(null); return a; })(70);
                            arrayOfString[0] = "\u3042";
                            arrayOfString[1] = "\u3044";
                            arrayOfString[2] = "\u3046";
                            arrayOfString[3] = "\u3048";
                            arrayOfString[4] = "\u304a";
                            arrayOfString[5] = "\u304b";
                            arrayOfString[6] = "\u304d";
                            arrayOfString[7] = "\u304f";
                            arrayOfString[8] = "\u3051";
                            arrayOfString[9] = "\u3053";
                            arrayOfString[10] = "\u3055";
                            arrayOfString[11] = "\u3057";
                            arrayOfString[12] = "\u3059";
                            arrayOfString[13] = "\u305b";
                            arrayOfString[14] = "\u305d";
                            arrayOfString[15] = "\u305f";
                            arrayOfString[16] = "\u3061";
                            arrayOfString[17] = "\u3064";
                            arrayOfString[18] = "\u3066";
                            arrayOfString[19] = "\u3068";
                            arrayOfString[20] = "\u306a";
                            arrayOfString[21] = "\u306b";
                            arrayOfString[22] = "\u306c";
                            arrayOfString[23] = "\u306d";
                            arrayOfString[24] = "\u306e";
                            arrayOfString[25] = "\u306f";
                            arrayOfString[26] = "\u3072";
                            arrayOfString[27] = "\u3075";
                            arrayOfString[28] = "\u3078";
                            arrayOfString[29] = "\u307b";
                            arrayOfString[30] = "\u307e";
                            arrayOfString[31] = "\u307f";
                            arrayOfString[32] = "\u3080";
                            arrayOfString[33] = "\u3081";
                            arrayOfString[34] = "\u3082";
                            arrayOfString[35] = "\u3084";
                            arrayOfString[36] = "\u3086";
                            arrayOfString[37] = "\u3088";
                            arrayOfString[38] = "\u3089";
                            arrayOfString[39] = "\u308a";
                            arrayOfString[40] = "\u308c";
                            arrayOfString[41] = "\u308d";
                            arrayOfString[42] = "\u308f";
                            arrayOfString[43] = "\u3092";
                            arrayOfString[44] = "\u3093";
                            arrayOfString[45] = "\u304c";
                            arrayOfString[46] = "\u304e";
                            arrayOfString[47] = "\u3050";
                            arrayOfString[48] = "\u3052";
                            arrayOfString[49] = "\u3054";
                            arrayOfString[50] = "\u3056";
                            arrayOfString[51] = "\u3058";
                            arrayOfString[52] = "\u305a";
                            arrayOfString[53] = "\u305c";
                            arrayOfString[54] = "\u305e";
                            arrayOfString[55] = "\u3060";
                            arrayOfString[56] = "\u3062";
                            arrayOfString[57] = "\u3065";
                            arrayOfString[58] = "\u3067";
                            arrayOfString[59] = "\u3069";
                            arrayOfString[60] = "\u3070";
                            arrayOfString[61] = "\u3073";
                            arrayOfString[62] = "\u3076";
                            arrayOfString[63] = "\u3079";
                            arrayOfString[64] = "\u307c";
                            arrayOfString[65] = "\u3071";
                            arrayOfString[66] = "\u3074";
                            arrayOfString[67] = "\u3077";
                            arrayOfString[68] = "\u307a";
                            arrayOfString[69] = "\u307d";
                            if (0 === paramLong) {
                                return arrayOfString[0];
                            }
                            var ln = arrayOfString.length;
                            var localArrayList = (new java.util.ArrayList());
                            var l;
                            do {
                                var j = ((paramLong % ln) | 0);
                                l = Math.floor(paramLong / ln);
                                localArrayList.add(arrayOfString[j]);
                                paramLong = l;
                            } while ((l >= ln));
                            if (l > 0) {
                                localArrayList.add(arrayOfString[(l | 0)]);
                            }
                            java.util.Collections.reverse(localArrayList);
                            return Digest.joinList("", localArrayList);
                        };
                        Digest.long71String_HiraganaDECODED = function (paramLong) {
                            var arrstring = ["\u3042", "\u3044", "\u3046", "\u3048", "\u304a", "\u304b", "\u304d", "\u304f", "\u3051", "\u3053", "\u3055", "\u3057", "\u3059", "\u305b", "\u305d", "\u305f", "\u3061", "\u3064", "\u3066", "\u3068", "\u306a", "\u306b", "\u306c", "\u306d", "\u306e", "\u306f", "\u3072", "\u3075", "\u3078", "\u307b", "\u307e", "\u307f", "\u3080", "\u3081", "\u3082", "\u3084", "\u3086", "\u3088", "\u3089", "\u308a", "\u308c", "\u308d", "\u308f", "\u3092", "\u3093", "\u304c", "\u304e", "\u3050", "\u3052", "\u3054", "\u3056", "\u3058", "\u305a", "\u305c", "\u305e", "\u3060", "\u3062", "\u3065", "\u3067", "\u3069", "\u3070", "\u3073", "\u3076", "\u3079", "\u307c", "\u3071", "\u3074", "\u3077", "\u307a", "\u307d"];
                            if (0 === paramLong) {
                                return arrstring[0];
                            }
                            var n = arrstring.length;
                            var arrayList = (new java.util.ArrayList());
                            var l;
                            do {
                                var n2 = ((paramLong % Math.floor(n)) | 0);
                                l = Math.floor(paramLong / Math.floor(n));
                                arrayList.add(arrstring[n2]);
                                paramLong = l;
                            } while ((l >= Math.floor(n)));
                            if (l > 0) {
                                arrayList.add(arrstring[(l | 0)]);
                            }
                            java.util.Collections.reverse(arrayList);
                            return Digest.joinList("", arrayList);
                        };
                        Digest.md5 = function (source) {
                            try {
                                var digestMD5 = java.security.MessageDigest.getInstance("MD5");
                                digestMD5.update(/* getBytes */ (source).split('').map(function (s) { return s.charCodeAt(0); }));
                                var paramString = digestMD5.digest();
                                paramString = Digest.forceMakeSigned(paramString);
                                var resultBuffer = new java.lang.StringBuffer();
                                var j = paramString.length;
                                var i = 0;
                                while ((i < j)) {
                                    var str = javaemul.internal.IntegerHelper.toHexString(paramString[i] & 255);
                                    if (str.length === 1) {
                                        resultBuffer.append("0");
                                    }
                                    resultBuffer.append(str);
                                    i += 1;
                                }
                                ;
                                return resultBuffer.toString();
                            }
                            catch (paramString) {
                                console.error(paramString.message, paramString);
                            }
                            ;
                            return "";
                        };
                        Digest.str36ToLong = function (paramStringSource) {
                            var paramString = (paramStringSource).split('');
                            var l = 0;
                            var l2 = 0;
                            var n = paramString.length - 1;
                            while ((n > -1)) {
                                var l3 = void 0;
                                if ('0'.charCodeAt(0) <= (function (c) { return c.charCodeAt == null ? c : c.charCodeAt(0); })(paramString[n]) && (function (c) { return c.charCodeAt == null ? c : c.charCodeAt(0); })(paramString[n]) <= '9'.charCodeAt(0)) {
                                    l3 = Math.floor((l + ((function (c) { return c.charCodeAt == null ? c : c.charCodeAt(0); })(paramString[n]) - 48) * Math.pow(36.0, l2)));
                                }
                                else if ('a'.charCodeAt(0) <= (function (c) { return c.charCodeAt == null ? c : c.charCodeAt(0); })(paramString[n]) && (function (c) { return c.charCodeAt == null ? c : c.charCodeAt(0); })(paramString[n]) <= 'z'.charCodeAt(0)) {
                                    l3 = Math.floor((l + ((function (c) { return c.charCodeAt == null ? c : c.charCodeAt(0); })(paramString[n]) - 97 + 10) * Math.pow(36.0, l2)));
                                }
                                else {
                                    l3 = l;
                                    if ('A'.charCodeAt(0) <= (function (c) { return c.charCodeAt == null ? c : c.charCodeAt(0); })(paramString[n])) {
                                        l3 = l;
                                        if ((function (c) { return c.charCodeAt == null ? c : c.charCodeAt(0); })(paramString[n]) <= 'Z'.charCodeAt(0)) {
                                            l3 = Math.floor((l + ((function (c) { return c.charCodeAt == null ? c : c.charCodeAt(0); })(paramString[n]) - 65 + 10) * Math.pow(36.0, l2)));
                                        }
                                    }
                                }
                                ++l2;
                                --n;
                                l = l3;
                            }
                            ;
                            return l;
                        };
                        Digest.str71ToInt_Hiragana = function (paramString) {
                            paramString = paramString.toLowerCase();
                            var arrayOfString = (function (s) { var a = []; while (s-- > 0)
                                a.push(null); return a; })(70);
                            arrayOfString[0] = "\u3042";
                            arrayOfString[1] = "\u3044";
                            arrayOfString[2] = "\u3046";
                            arrayOfString[3] = "\u3048";
                            arrayOfString[4] = "\u304a";
                            arrayOfString[5] = "\u304b";
                            arrayOfString[6] = "\u304d";
                            arrayOfString[7] = "\u304f";
                            arrayOfString[8] = "\u3051";
                            arrayOfString[9] = "\u3053";
                            arrayOfString[10] = "\u3055";
                            arrayOfString[11] = "\u3057";
                            arrayOfString[12] = "\u3059";
                            arrayOfString[13] = "\u305b";
                            arrayOfString[14] = "\u305d";
                            arrayOfString[15] = "\u305f";
                            arrayOfString[16] = "\u3061";
                            arrayOfString[17] = "\u3064";
                            arrayOfString[18] = "\u3066";
                            arrayOfString[19] = "\u3068";
                            arrayOfString[20] = "\u306a";
                            arrayOfString[21] = "\u306b";
                            arrayOfString[22] = "\u306c";
                            arrayOfString[23] = "\u306d";
                            arrayOfString[24] = "\u306e";
                            arrayOfString[25] = "\u306f";
                            arrayOfString[26] = "\u3072";
                            arrayOfString[27] = "\u3075";
                            arrayOfString[28] = "\u3078";
                            arrayOfString[29] = "\u307b";
                            arrayOfString[30] = "\u307e";
                            arrayOfString[31] = "\u307f";
                            arrayOfString[32] = "\u3080";
                            arrayOfString[33] = "\u3081";
                            arrayOfString[34] = "\u3082";
                            arrayOfString[35] = "\u3084";
                            arrayOfString[36] = "\u3086";
                            arrayOfString[37] = "\u3088";
                            arrayOfString[38] = "\u3089";
                            arrayOfString[39] = "\u308a";
                            arrayOfString[40] = "\u308c";
                            arrayOfString[41] = "\u308d";
                            arrayOfString[42] = "\u308f";
                            arrayOfString[43] = "\u3092";
                            arrayOfString[44] = "\u3093";
                            arrayOfString[45] = "\u304c";
                            arrayOfString[46] = "\u304e";
                            arrayOfString[47] = "\u3050";
                            arrayOfString[48] = "\u3052";
                            arrayOfString[49] = "\u3054";
                            arrayOfString[50] = "\u3056";
                            arrayOfString[51] = "\u3058";
                            arrayOfString[52] = "\u305a";
                            arrayOfString[53] = "\u305c";
                            arrayOfString[54] = "\u305e";
                            arrayOfString[55] = "\u3060";
                            arrayOfString[56] = "\u3062";
                            arrayOfString[57] = "\u3065";
                            arrayOfString[58] = "\u3067";
                            arrayOfString[59] = "\u3069";
                            arrayOfString[60] = "\u3070";
                            arrayOfString[61] = "\u3073";
                            arrayOfString[62] = "\u3076";
                            arrayOfString[63] = "\u3079";
                            arrayOfString[64] = "\u307c";
                            arrayOfString[65] = "\u3071";
                            arrayOfString[66] = "\u3074";
                            arrayOfString[67] = "\u3077";
                            arrayOfString[68] = "\u307a";
                            arrayOfString[69] = "\u307d";
                            var arrayList = (new java.util.ArrayList(java.util.Arrays.asList(arrayOfString)));
                            var n = arrayOfString.length;
                            var l = 0;
                            var n2 = paramString.length;
                            for (var i = 0; i < n2; ++i) {
                                var l2 = void 0;
                                l = l2 = l + Math.floor(arrayList.indexOf(paramString.substring(i, i + 1)));
                                if (i === n2 - 1)
                                    continue;
                                l = l2 * Math.floor(n);
                            }
                            ;
                            return l;
                        };
                        Digest.str71ToInt_HiraganaDECODED = function (string) {
                            string = string.toLowerCase();
                            var arrstring = ["\u3042", "\u3044", "\u3046", "\u3048", "\u304a", "\u304b", "\u304d", "\u304f", "\u3051", "\u3053", "\u3055", "\u3057", "\u3059", "\u305b", "\u305d", "\u305f", "\u3061", "\u3064", "\u3066", "\u3068", "\u306a", "\u306b", "\u306c", "\u306d", "\u306e", "\u306f", "\u3072", "\u3075", "\u3078", "\u307b", "\u307e", "\u307f", "\u3080", "\u3081", "\u3082", "\u3084", "\u3086", "\u3088", "\u3089", "\u308a", "\u308c", "\u308d", "\u308f", "\u3092", "\u3093", "\u304c", "\u304e", "\u3050", "\u3052", "\u3054", "\u3056", "\u3058", "\u305a", "\u305c", "\u305e", "\u3060", "\u3062", "\u3065", "\u3067", "\u3069", "\u3070", "\u3073", "\u3076", "\u3079", "\u307c", "\u3071", "\u3074", "\u3077", "\u307a", "\u307d"];
                            var arrayList = (new java.util.ArrayList(java.util.Arrays.asList(arrstring)));
                            var n = arrstring.length;
                            var l = 0;
                            var n2 = string.length;
                            for (var i = 0; i < n2; ++i) {
                                var l2 = void 0;
                                l = l2 = l + Math.floor(arrayList.indexOf(string.substring(i, i + 1)));
                                if (i === n2 - 1)
                                    continue;
                                l = l2 * Math.floor(n);
                            }
                            ;
                            return l;
                        };
                        Digest.stringWithFill = function (source, filler, numberOfTimes) {
                            var lengthToFill = numberOfTimes - source.length;
                            if (lengthToFill <= 0) {
                                return source;
                            }
                            var stringBuilder = new java.lang.StringBuilder();
                            stringBuilder.append(source);
                            for (numberOfTimes = 0; numberOfTimes < lengthToFill; ++numberOfTimes) {
                                stringBuilder.append(filler);
                            }
                            ;
                            return new String(stringBuilder);
                        };
                        Digest.stringWithFillLeft = function (source, filler, numberOfTimes) {
                            var str = "";
                            numberOfTimes -= source.length;
                            while ((numberOfTimes > 0)) {
                                str = str + filler;
                                numberOfTimes -= 1;
                            }
                            ;
                            return str + source;
                        };
                        Digest.forceMakeSigned = function (input) {
                            var result = (function (s) { var a = []; while (s-- > 0)
                                a.push(0); return a; })(input.length);
                            var d;
                            for (var i = 0; i < input.length; i++) {
                                var b = input[i];
                                d = (b | 0);
                                d = (d > 128 ? d - 256 : d);
                                result[i] = ((d) | 0);
                            }
                            ;
                            return result;
                        };
                        Digest.joinList = function (delimiter, list) {
                            var result = "";
                            for (var i = 0; i < list.size(); i++) {
                                var s = list.get(i);
                                result += s;
                                if (i !== list.size() - 1) {
                                    result += delimiter;
                                }
                            }
                            ;
                            return result;
                        };
                        Digest.reverseIt = function (source) {
                            var i = 0;
                            var len = source.length;
                            var dest = new java.lang.StringBuilder(len);
                            for (i = (len - 1); i >= 0; i--) {
                                dest.append(source.charAt(i));
                            }
                            ;
                            return dest.toString();
                        };
                        return Digest;
                    }());
                    util.Digest = Digest;
                    Digest["__class"] = "ru.bvb.oniongames.plugin.util.Digest";
                })(util = plugin.util || (plugin.util = {}));
            })(plugin = oniongames.plugin || (oniongames.plugin = {}));
        })(oniongames = bvb.oniongames || (bvb.oniongames = {}));
    })(bvb = ru.bvb || (ru.bvb = {}));
})(ru || (ru = {}));
(function (ru) {
    var bvb;
    (function (bvb) {
        var oniongames;
        (function (oniongames) {
            var plugin;
            (function (plugin) {
                var util;
                (function (util) {
                    var SpellEncoder = (function () {
                        function SpellEncoder() {
                        }
                        SpellEncoder.FAKE_UNIX_TIME_$LI$ = function () { if (SpellEncoder.FAKE_UNIX_TIME == null)
                            SpellEncoder.FAKE_UNIX_TIME = 1550347678 * 1000; return SpellEncoder.FAKE_UNIX_TIME; };
                        ;
                        SpellEncoder.generateAppId = function () {
                            if (SpellEncoder.useFakeData) {
                                return SpellEncoder.FAKE_APP_ID;
                            }
                            var l = new Date().getTime();
                            var i = new java.util.Random().nextInt();
                            return ru.bvb.oniongames.plugin.util.Digest.md5(l + "" + i);
                        };
                        SpellEncoder.generateRandomSeed = function (isJPSeed) {
                            if (SpellEncoder.useFakeData) {
                                return isJPSeed ? SpellEncoder.FAKE_SEED_JP : SpellEncoder.FAKE_SEED;
                            }
                            if (isJPSeed) {
                                return Math.floor((((Math.random() * 4000.0) | 0)));
                            }
                            return Math.floor((((Math.random() * 36.0) | 0)));
                        };
                        SpellEncoder.getTime = function () {
                            if (SpellEncoder.useFakeData) {
                                return SpellEncoder.FAKE_UNIX_TIME_$LI$();
                            }
                            return new Date().getTime();
                        };
                        SpellEncoder.generateRandomValidKey = function (generateJPKey, dungeonId, dungeonLevel) {
                            var appIdKey = SpellEncoder.generateAppId();
                            var randomSeed = SpellEncoder.generateRandomSeed(generateJPKey);
                            var unixTimeMs = SpellEncoder.getTime();
                            return SpellEncoder.encode(appIdKey, randomSeed, dungeonId, dungeonLevel, unixTimeMs, generateJPKey);
                        };
                        SpellEncoder.encode = function (appIdKey, randomSeed, dungeonId, dungeonLevel, unixTimeMs, generateJPKey) {
                            if (appIdKey == null) {
                                return null;
                            }
                            try {
                                if (generateJPKey) {
                                    return ru.bvb.oniongames.plugin.crypto.GiftSpell.create_JP(appIdKey, randomSeed, dungeonId, dungeonLevel, unixTimeMs);
                                }
                                return ru.bvb.oniongames.plugin.crypto.GiftSpell.create_OTHER(appIdKey, randomSeed, dungeonId, dungeonLevel, unixTimeMs);
                            }
                            catch (e) {
                                console.info(e);
                            }
                            ;
                            return null;
                        };
                        return SpellEncoder;
                    }());
                    SpellEncoder.FAKE_APP_ID = "6512bd43d9caa6e02c990b0a82652dca";
                    SpellEncoder.FAKE_SEED = 28;
                    SpellEncoder.FAKE_SEED_JP = 42;
                    SpellEncoder.useFakeData = false;
                    util.SpellEncoder = SpellEncoder;
                    SpellEncoder["__class"] = "ru.bvb.oniongames.plugin.util.SpellEncoder";
                })(util = plugin.util || (plugin.util = {}));
            })(plugin = oniongames.plugin || (oniongames.plugin = {}));
        })(oniongames = bvb.oniongames || (bvb.oniongames = {}));
    })(bvb = ru.bvb || (ru.bvb = {}));
})(ru || (ru = {}));
ru.bvb.oniongames.plugin.util.SpellEncoder.FAKE_UNIX_TIME_$LI$();
ru.bvb.Dungeons.dungeonNames_$LI$();
ru.bvb.Dungeons.dungeonIDs_$LI$();
ru.bvb.Main.main(null);
//# sourceMappingURL=bundle.js.map